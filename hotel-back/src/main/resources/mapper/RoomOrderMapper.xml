<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.gok.hotel.mapper.RoomOrderMapper">
    <insert id="insertOrder" parameterType="cn.gok.hotel.entity.RoomOrder">
        INSERT INTO room_order (
            member_id, member_name, contact_phone, room_type_id, room_number_id, room_number_name, checkin_time, enter_time, leave_time
        ) VALUES (
            #{memberId}, #{memberName}, #{contactPhone}, #{roomTypeId}, #{roomNumberId}, #{roomNumberName}, #{checkinTime}, #{enterTime}, #{leaveTime}
        )
    </insert>
    <select id="selectByMemberId" resultType="cn.gok.hotel.entity.RoomOrder">
    SELECT * FROM room_order WHERE member_id = #{memberId} ORDER BY checkin_time DESC
</select>
<select id="selectById" resultType="cn.gok.hotel.entity.RoomOrder">
    SELECT * FROM room_order WHERE order_id = #{orderId}
</select>
<select id="selectAll" resultType="cn.gok.hotel.entity.RoomOrder">
    SELECT * FROM room_order ORDER BY checkin_time DESC
</select>
<select id="countOverlapOrder" resultType="int">
    SELECT COUNT(*) FROM room_order
    WHERE member_id = #{memberId}
      AND (
        (enter_time &lt;= #{leaveTime} AND leave_time &gt;= #{enterTime})
      )
</select>
<select id="countOrders" resultType="int">
    SELECT COUNT(*) FROM room_order
</select>
<select id="selectTodayOrders" resultType="cn.gok.hotel.entity.RoomOrder">
    SELECT * FROM room_order WHERE DATE(checkin_time) = #{today} ORDER BY checkin_time DESC
</select>
<delete id="deleteById">
    DELETE FROM room_order WHERE order_id = #{orderId}
</delete>
</mapper>
